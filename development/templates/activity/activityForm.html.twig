<div class="bg-slate-900 border border-slate-800 p-6 md:p-7 rounded-3xl shadow-2xl w-full max-w-xl mt-6 md:mt-8">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-xl md:text-lg font-black italic tracking-tighter text-blue-500 uppercase">Nueva Sesi√≥n</h2>
        <button @click="$emit('close')" class="text-slate-500 hover:text-white transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
        </button>
    </div>

    <div class="flex bg-slate-950 p-1 rounded-xl mb-6 border border-slate-800">
        <button @click="localType = 'strength'" 
            :class="localType === 'strength' ? 'bg-blue-600 text-white shadow-lg' : 'text-slate-500'"
            class="flex-1 py-4 rounded-lg font-bold uppercase text-sm transition-all">üèãÔ∏è Fuerza</button>
        <button @click="localType = 'cardio'" 
            :class="localType === 'cardio' ? 'bg-blue-600 text-white shadow-lg' : 'text-slate-500'"
            class="flex-1 py-4 rounded-lg font-bold uppercase text-sm transition-all ml-1">üèÉ Cardio</button>
    </div>

    <div class="space-y-4 mb-6">
        <div v-if="localType === 'strength'" class="space-y-4">
            <div v-for="(set, index) in currentSets" :key="index" class="bg-slate-950 border border-slate-800 rounded-2xl p-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                    <div>
                        <label class="block text-xs uppercase tracking-widest text-slate-500 mb-2">Ejercicio</label>
                        <input v-model="set.exercise" type="text" placeholder="Ej: Press militar" class="w-full bg-slate-900 border-slate-800 rounded-xl text-slate-100 text-base p-4 placeholder-slate-600" />
                    </div>
                    <div>
                        <label class="block text-xs uppercase tracking-widest text-slate-500 mb-2">Peso (kg)</label>
                        <div class="relative">
                            <input v-model.number="set.weight" type="number" step="2.5" placeholder="Ej: 50" class="w-full bg-slate-900 border-slate-800 rounded-xl text-slate-100 text-base p-4 pr-12 placeholder-slate-600" />
                            <div class="absolute right-2 top-1/2 -translate-y-1/2 flex flex-col gap-1">
                                <button type="button" @click="adjustValue(set, 'weight', 2.5)" class="h-4 w-6 text-[10px] rounded bg-slate-800 text-slate-200 hover:bg-slate-700">+</button>
                                <button type="button" @click="adjustValue(set, 'weight', -2.5)" class="h-4 w-6 text-[10px] rounded bg-slate-800 text-slate-200 hover:bg-slate-700">‚àí</button>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs uppercase tracking-widest text-slate-500 mb-2">Repeticiones</label>
                        <div class="relative">
                            <input v-model.number="set.reps" type="number" placeholder="Ej: 10" class="w-full bg-slate-900 border-slate-800 rounded-xl text-slate-100 text-base p-4 pr-12 placeholder-slate-600" />
                            <div class="absolute right-2 top-1/2 -translate-y-1/2 flex flex-col gap-1">
                                <button type="button" @click="adjustValue(set, 'reps', 1)" class="h-4 w-6 text-[10px] rounded bg-slate-800 text-slate-200 hover:bg-slate-700">+</button>
                                <button type="button" @click="adjustValue(set, 'reps', -1)" class="h-4 w-6 text-[10px] rounded bg-slate-800 text-slate-200 hover:bg-slate-700">‚àí</button>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs uppercase tracking-widest text-slate-500 mb-2">RIR (reps en reserva)</label>
                        <div class="relative">
                            <input v-model.number="set.rir" type="number" placeholder="Ej: 2" class="w-full bg-slate-900 border-slate-800 rounded-xl text-slate-100 text-base p-4 pr-12 placeholder-slate-600" />
                            <div class="absolute right-2 top-1/2 -translate-y-1/2 flex flex-col gap-1">
                                <button type="button" @click="adjustValue(set, 'rir', 1)" class="h-4 w-6 text-[10px] rounded bg-slate-800 text-slate-200 hover:bg-slate-700">+</button>
                                <button type="button" @click="adjustValue(set, 'rir', -1)" class="h-4 w-6 text-[10px] rounded bg-slate-800 text-slate-200 hover:bg-slate-700">‚àí</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mt-3">
                    <label class="block text-xs uppercase tracking-widest text-slate-500 mb-2">Nota (opcional)</label>
                    <input v-model="set.note" type="text" placeholder="Ej: buena t√©cnica" class="w-full bg-slate-900 border-slate-800 rounded-xl text-slate-100 text-base p-4 placeholder-slate-600" />
                </div>
                <div class="text-right mt-3">
                    <button @click="removeSet(index)" type="button" class="text-xs text-slate-500 hover:text-white">Eliminar set</button>
                </div>
            </div>
        </div>

        <div v-else class="space-y-4">
            <div v-for="(set, index) in currentSets" :key="index" class="bg-slate-950 border border-slate-800 rounded-2xl p-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                    <div>
                        <label class="block text-xs uppercase tracking-widest text-slate-500 mb-2">Actividad</label>
                        <input v-model="set.activityName" type="text" placeholder="Ej: Running" class="w-full bg-slate-900 border-slate-800 rounded-xl text-slate-100 text-base p-4 placeholder-slate-600" />
                    </div>
                    <div>
                        <label class="block text-xs uppercase tracking-widest text-slate-500 mb-2">Distancia (km)</label>
                        <div class="relative">
                            <input v-model.number="set.distanceKm" type="number" step="0.1" placeholder="Ej: 5.5" class="w-full bg-slate-900 border-slate-800 rounded-xl text-slate-100 text-base p-4 pr-12 placeholder-slate-600" />
                            <div class="absolute right-2 top-1/2 -translate-y-1/2 flex flex-col gap-1">
                                <button type="button" @click="adjustValue(set, 'distanceKm', 0.1)" class="h-4 w-6 text-[10px] rounded bg-slate-800 text-slate-200 hover:bg-slate-700">+</button>
                                <button type="button" @click="adjustValue(set, 'distanceKm', -0.1)" class="h-4 w-6 text-[10px] rounded bg-slate-800 text-slate-200 hover:bg-slate-700">‚àí</button>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs uppercase tracking-widest text-slate-500 mb-2">Duraci√≥n (min)</label>
                        <div class="relative">
                            <input v-model.number="set.durationMinutes" type="number" placeholder="Ej: 30" class="w-full bg-slate-900 border-slate-800 rounded-xl text-slate-100 text-base p-4 pr-12 placeholder-slate-600" />
                            <div class="absolute right-2 top-1/2 -translate-y-1/2 flex flex-col gap-1">
                                <button type="button" @click="adjustValue(set, 'durationMinutes', 1)" class="h-4 w-6 text-[10px] rounded bg-slate-800 text-slate-200 hover:bg-slate-700">+</button>
                                <button type="button" @click="adjustValue(set, 'durationMinutes', -1)" class="h-4 w-6 text-[10px] rounded bg-slate-800 text-slate-200 hover:bg-slate-700">‚àí</button>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs uppercase tracking-widest text-slate-500 mb-2">FC media (opcional)</label>
                        <div class="relative">
                            <input v-model.number="set.avgHeartRate" type="number" placeholder="Ej: 155" class="w-full bg-slate-900 border-slate-800 rounded-xl text-slate-100 text-base p-4 pr-12 placeholder-slate-600" />
                            <div class="absolute right-2 top-1/2 -translate-y-1/2 flex flex-col gap-1">
                                <button type="button" @click="adjustValue(set, 'avgHeartRate', 1)" class="h-4 w-6 text-[10px] rounded bg-slate-800 text-slate-200 hover:bg-slate-700">+</button>
                                <button type="button" @click="adjustValue(set, 'avgHeartRate', -1)" class="h-4 w-6 text-[10px] rounded bg-slate-800 text-slate-200 hover:bg-slate-700">‚àí</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mt-3">
                    <label class="block text-xs uppercase tracking-widest text-slate-500 mb-2">Nota (opcional)</label>
                    <input v-model="set.note" type="text" placeholder="Ej: ritmo suave" class="w-full bg-slate-900 border-slate-800 rounded-xl text-slate-100 text-base p-4 placeholder-slate-600" />
                </div>
                <div class="text-right mt-3">
                    <button @click="removeSet(index)" type="button" class="text-xs text-slate-500 hover:text-white">Eliminar set</button>
                </div>
            </div>
        </div>

        <button @click="addSet" type="button" class="w-full bg-slate-800 hover:bg-slate-700 text-white py-4 rounded-xl text-sm uppercase tracking-widest">A√±adir set</button>
    </div>

    <button 
        @click="submitForm" 
        :disabled="isSaving"
        class="w-full bg-blue-600 hover:bg-blue-500 text-white py-5 rounded-2xl font-black uppercase text-sm tracking-[0.2em] transition-all active:scale-95 disabled:opacity-50">
        <span v-if="!isSaving">Registrar Entrenamiento</span>
        <span v-else class="flex items-center justify-center italic">
            <svg class="animate-spin h-4 w-4 mr-2 border-2 border-white/20 border-t-white rounded-full" viewBox="0 0 24 24"></svg>
            Procesando...
        </span>
    </button>
</div>